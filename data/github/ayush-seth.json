{
  "last_updated": 1700301288.0,
  "activity": [
    {
      "type": "comment_created",
      "title": "coronasafe/care_fe#6665",
      "time": 1700301288.0,
      "link": "https://github.com/coronasafe/care_fe/issues/6665#issuecomment-1817463174",
      "text": "This is a bigger problem at its core with how route protection and login is being handled and just replacing `window.location.href =` with `navigate()` is not going to solve these issues. \r\n\r\nFor ex. when I am logged out and I navigate to `/shifting/board`, instead of being redirected to `/login` I stay on `/shifting/board` and in those cases, after logging in, it does `window.location.href = window.location.pathname.toString()`, using `navigate` here won't do anything because the path does not change, you have to reload the whole page. Same goes for any other url."
    },
    {
      "type": "comment_created",
      "title": "coronasafe/care_fe#6665",
      "time": 1700300406.0,
      "link": "https://github.com/coronasafe/care_fe/issues/6665#issuecomment-1817458427",
      "text": "Any reason this project is using [raviger](https://github.com/kyeotic/raviger) which barely anyone has ever heard of and has not been updated since 2022 instead of using the industry standard [React Router](https://github.com/remix-run/react-router)?"
    },
    {
      "type": "comment_created",
      "title": "coronasafe/care_fe#6503",
      "time": 1700239006.0,
      "link": "https://github.com/coronasafe/care_fe/issues/6503#issuecomment-1816739173",
      "text": "I can pick this up if still required"
    },
    {
      "type": "comment_created",
      "title": "coronasafe/care_fe#6608",
      "time": 1700238801.0,
      "link": "https://github.com/coronasafe/care_fe/issues/6608#issuecomment-1816734216",
      "text": "@rithviknishad is this under the same category? Only state admin should see this button?"
    },
    {
      "type": "pr_opened",
      "title": "coronasafe/care_fe#6663",
      "time": 1700237433.0,
      "link": "https://github.com/coronasafe/care_fe/pull/6663",
      "text": "show delete user button only for stateAdmin"
    },
    {
      "type": "comment_created",
      "title": "coronasafe/care_fe#6660",
      "time": 1700236158.0,
      "link": "https://github.com/coronasafe/care_fe/issues/6660#issuecomment-1816668248",
      "text": "cool, I can take this up. Can you assign it to me? @rithviknishad \r\n"
    },
    {
      "type": "comment_created",
      "title": "coronasafe/care_fe#6660",
      "time": 1700233608.0,
      "link": "https://github.com/coronasafe/care_fe/issues/6660#issuecomment-1816593105",
      "text": "This is the function that controls the visibility of the delete button\r\n```typescript\r\n const showDelete = (user: any) => {\r\n    const STATE_ADMIN_LEVEL = USER_TYPES.indexOf(\"StateAdmin\");\r\n    const STATE_READ_ONLY_ADMIN_LEVEL =\r\n      USER_TYPES.indexOf(\"StateReadOnlyAdmin\");\r\n    const DISTRICT_ADMIN_LEVEL = USER_TYPES.indexOf(\"DistrictAdmin\");\r\n    const level = USER_TYPES.indexOf(user.user_type);\r\n    const currentUserLevel = USER_TYPES.indexOf(authUser.user_type);\r\n    if (user.is_superuser) return true;\r\n\r\n    if (currentUserLevel >= STATE_ADMIN_LEVEL)\r\n      return user.state_object?.id === authUser.state;\r\n    if (\r\n      currentUserLevel < STATE_READ_ONLY_ADMIN_LEVEL &&\r\n      currentUserLevel >= DISTRICT_ADMIN_LEVEL &&\r\n      currentUserLevel > level\r\n    )\r\n      return facilityData?.district_object_id === authUser.district;\r\n    return false;\r\n  };\r\n ```\r\n \r\nReproducing the issue, I can see that the delete button is visible because the 3rd `if` condition is evaluating to `true` which because `currentUserLevel > level` which implies that the `authUser` should be able to delete `user` and they also belong to the same `district`. Which makes me think something is wrong on the backend here? Since the logic for showing the button seems to be right. How can I find out why exactly the backend API is failing?"
    }
  ],
  "open_prs": [
    {
      "link": "https://github.com/coronasafe/care_fe/pull/6663",
      "title": "show delete user button only for stateAdmin",
      "stale_for": 1,
      "labels": [
        "needs testing"
      ]
    }
  ],
  "authored_issue_and_pr": []
}